# 研究系统优化 - 环境变量配置示例
# 复制此文件为 .env 并根据需要修改

# ═══════════════════════════════════════════════════════════════
# Mem0记忆功能配置（基于Mem0 + Milvus + PostgreSQL）
# ═══════════════════════════════════════════════════════════════

# Mem0记忆功能主开关（true=启用, false=禁用）
# 默认: false（禁用，零性能开销）
ENABLE_MEM0_MEMORY=false

# Mem0专用PostgreSQL数据库（用于存储记忆元数据）
MEM0_POSTGRES_DB=mem0_memories

# Mem0专用Milvus集合名称（用于向量存储）
MEM0_MILVUS_COLLECTION=user_memories

# Mem0使用的LLM模型（用于智能抽取）
MEM0_LLM_MODEL=qwen-plus

# Mem0使用的Embedding模型（用于向量化）
MEM0_EMBEDDING_MODEL=text-embedding-v1

# ═══════════════════════════════════════════════════════════════
# 旧版记忆功能配置（已废弃，保留以兼容）
# ═══════════════════════════════════════════════════════════════

# 记忆功能主开关（true=启用, false=禁用）
# 默认: false（禁用，零性能开销）
ENABLE_MEMORY=false

# 记忆提供者类型（noop, milvus, full）
MEMORY_PROVIDER_TYPE=milvus

# ═══════════════════════════════════════════════════════════════
# Milvus配置
# ═══════════════════════════════════════════════════════════════

MILVUS_HOST=localhost
MILVUS_PORT=19530
MILVUS_COLLECTION=research_memory

# ═══════════════════════════════════════════════════════════════
# Embedding模型
# ═══════════════════════════════════════════════════════════════

EMBEDDING_MODEL=sentence-transformers/all-MiniLM-L6-v2

# ═══════════════════════════════════════════════════════════════
# PostgreSQL配置 - Text2SQL智能体
# ═══════════════════════════════════════════════════════════════

# PostgreSQL数据库连接配置
POSTGRES_HOST=localhost
POSTGRES_PORT=5432
POSTGRES_USER=research_readonly
POSTGRES_PASSWORD=readonly_password_2024
POSTGRES_DB=research_reports_db

# ═══════════════════════════════════════════════════════════════
# LLM模型配置（支持OpenAI兼容API）
# ═══════════════════════════════════════════════════════════════

# API密钥
DASHSCOPE_API_KEY=sk-your-api-key-here

# API基础URL
# 阿里云通义千问（默认）
DASHSCOPE_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1

# 硅基流动（备选方案）
# DASHSCOPE_BASE_URL=https://api.siliconflow.cn/v1

# 其他OpenAI兼容服务
# DASHSCOPE_BASE_URL=https://your-service.com/v1

# ═══════════════════════════════════════════════════════════════
# Text2SQL智能体配置
# ═══════════════════════════════════════════════════════════════

# Text2SQL专用模型（优先级最高）
# 阿里云通义千问示例
TEXT2SQL_MODEL=qwen-plus

# 硅基流动示例（需配合上面的BASE_URL）
# TEXT2SQL_MODEL=Qwen/Qwen2.5-7B-Instruct
# TEXT2SQL_MODEL=deepseek-ai/DeepSeek-V2.5

# 启用Text2SQL工具
TEXT2SQL_ENABLED=true

# 最大重试次数（SQL执行失败时）
TEXT2SQL_MAX_RETRIES=3

# SQL缓存配置
TEXT2SQL_CACHE_ENABLED=true
TEXT2SQL_CACHE_THRESHOLD=0.95

# Few-shot示例数量
TEXT2SQL_FEWSHOT_K=3

# 是否使用动态Prompt生成
TEXT2SQL_USE_DYNAMIC_PROMPT=true

# 是否使用Schema图优化
TEXT2SQL_USE_SCHEMA_GRAPH=true

# 查询结果限制
TEXT2SQL_TOP_K_RESULTS=100

# ═══════════════════════════════════════════════════════════════
# 使用建议
# ═══════════════════════════════════════════════════════════════

# 【记忆功能】
# 生产环境（推荐）: ENABLE_MEMORY=false
# 测试环境: ENABLE_MEMORY=true

# 【PostgreSQL配置】
#   - 使用只读用户（research_readonly）确保安全
#   - 使用独立数据库（research_reports_db）与app_db分离
#   - 在Docker环境中，POSTGRES_HOST应设为 'postgres'（容器名）
#   - 本地开发时，POSTGRES_HOST设为 'localhost'
#   - Docker会自动创建research_reports_db并初始化数据

# 【LLM模型切换】
# 方式1：使用阿里云通义千问（默认）
#   DASHSCOPE_API_KEY=sk-xxx
#   DASHSCOPE_BASE_URL=https://dashscope.aliyuncs.com/compatible-mode/v1
#   TEXT2SQL_MODEL=qwen-plus

# 方式2：使用硅基流动
#   DASHSCOPE_API_KEY=sk-xxx  （硅基流动的key）
#   DASHSCOPE_BASE_URL=https://api.siliconflow.cn/v1
#   TEXT2SQL_MODEL=Qwen/Qwen2.5-7B-Instruct

# 方式3：使用其他OpenAI兼容服务
#   DASHSCOPE_API_KEY=your-api-key
#   DASHSCOPE_BASE_URL=https://your-service.com/v1
#   TEXT2SQL_MODEL=your-model-name

# 注意：
#   - 只需改环境变量，不需要改代码！
#   - 所有OpenAI兼容的API都支持
#   - TEXT2SQL_MODEL优先级高于LLM_MODEL

