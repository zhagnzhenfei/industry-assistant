# ═══════════════════════════════════════════════════════════════
# 研究系统配置参数详解
# ═══════════════════════════════════════════════════════════════

# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 记忆功能
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 是否启用记忆功能（true=启用, false=禁用）
ENABLE_MEMORY=false


# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 搜索API配置
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 搜索API选择（serper 或 tavily）
SEARCH_API=serper

# Serper API密钥（使用Google搜索）
SERPER_API_KEY=your_serper_key_here

# Tavily API密钥（可选，如果使用SEARCH_API=tavily）
# TAVILY_API_KEY=your_tavily_key_here

# 通义千问API密钥（必需）
DASHSCOPE_API_KEY=your_dashscope_key_here


# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 搜索控制参数（核心配置，控制搜索次数）
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# ┌─────────────────────────────────────────────────────────────┐
# │ 1. MAX_RESEARCHER_ITERATIONS (监督者层面 - 规划轮次)          │
# └─────────────────────────────────────────────────────────────┘
# 含义: 监督者（supervisor）规划和执行研究的轮次
#
# ⚠️ 重要：这个参数控制"监督者规划几次"，每次规划会启动N个研究者！
# 
# 工作流程:
#   第1轮: 监督者规划 → 启动N个研究者（并行）→ 收集结果
#   第2轮: 监督者分析结果 → 发现不足 → 再启动M个研究者 → 收集结果
#   第3轮: 继续补充...
#
# 设置建议:
#   1 = 只规划1次，不补充（最省钱，适合简单问题）
#   2 = 可以规划2次，允许1次补充（推荐，平衡质量和成本）
#   3 = 默认值，允许充分探索（复杂问题）
#
# 影响: 这个值越大，可能启动的研究者总数越多
#
MAX_RESEARCHER_ITERATIONS=1


# ┌─────────────────────────────────────────────────────────────┐
# │ 2. MAX_CONCURRENT_RESEARCH_UNITS (监督者层面 - 并行数) ⚠️重要  │
# └─────────────────────────────────────────────────────────────┘
# 含义: 每轮规划中，监督者并行启动多少个研究者
#
# 说明: 这是控制成本的关键参数！
#   - 监督者会分析问题，拆分成N个研究主题
#   - 然后并行启动N个研究者
#   - N受此参数限制
#
# 工作流程:
#   问题: "Python vs JavaScript 性能对比"
#   监督者分析: 拆分为5个主题
#     1. Python性能特点
#     2. JavaScript性能特点
#     3. 数值计算对比
#     4. Web服务器对比
#     5. 异步I/O对比
#   
#   如果 MAX_CONCURRENT_RESEARCH_UNITS=5:
#     → 同时启动5个研究者（你的情况！）
#   
#   如果 MAX_CONCURRENT_RESEARCH_UNITS=2:
#     → 只启动前2个研究者（其他被忽略）
#
# 设置建议:
#   1-2 = 极简模式（推荐，成本最低）
#   3 = 标准模式（平衡）
#   5 = 默认值（深度研究，成本高）
#
# 影响: 这是最影响成本的参数！
#   MAX_CONCURRENT_RESEARCH_UNITS × MAX_RESEARCHER_ITERATIONS = 总研究者数
#
MAX_CONCURRENT_RESEARCH_UNITS=2


# ┌─────────────────────────────────────────────────────────────┐
# │ 3. MAX_REACT_TOOL_CALLS (单个研究者层面 - 轮次)               │
# └─────────────────────────────────────────────────────────────┘
# 含义: 单个研究者（researcher）执行工具调用的最大轮次
#
# 工作流程:
#   第1轮: 研究者搜索 → think思考 → 决定是否继续
#   第2轮: 研究者补充搜索 → think思考 → 决定是否继续
#   第3轮: ...
#
# 设置建议:
#   1 = 只允许搜索1轮（极简，单次搜索必须够用）
#   2 = 允许2轮（推荐，首次搜索+1次补充）
#   3 = 默认值，允许多次调整
#
# 影响: 控制单个研究者的"来回"次数
#
MAX_REACT_TOOL_CALLS=2


# ┌─────────────────────────────────────────────────────────────┐
# │ 4. MAX_TOTAL_SEARCHES_PER_RESEARCHER (单个研究者层面 - 总数)  │
# └─────────────────────────────────────────────────────────────┘
# 含义: 单个研究者在所有轮次中，最多可以执行的搜索总次数
#
# 说明: 这是一个累计限制，防止某个研究者疯狂搜索
#
# 设置建议:
#   1 = 只能搜索1次（极简，可能信息不够）
#   2 = 最多搜索2次（推荐最小值，允许补充）
#   3 = 最多搜索3次（平衡，一般够用）
#   5 = 默认值，充分搜索
#
# 影响: 这个值应该 >= MAX_REACT_TOOL_CALLS（每轮至少1次搜索）
#
# 建议: 设为 MAX_REACT_TOOL_CALLS 的1-2倍
MAX_TOTAL_SEARCHES_PER_RESEARCHER=3


# ┌─────────────────────────────────────────────────────────────┐
# │ 5. MAX_SEARCHES_PER_ITERATION (单个研究者层面 - 每轮并行数)    │
# └─────────────────────────────────────────────────────────────┘
# 含义: 在单轮迭代中，研究者可以并行执行的搜索数量
#
# 说明: 
#   1 = 每轮只搜索1个关键词（串行）
#   2 = 每轮可以同时搜索2个关键词（并行）
#
# 设置建议:
#   1 = 串行搜索，更节省，足够用（推荐）
#   2 = 并行搜索，稍快但消耗多
#
# 影响: 影响搜索的并行度，不影响总次数
#
MAX_SEARCHES_PER_ITERATION=1


# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 参数关系和实际效果
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# 举例说明（假设监督者启动2个研究者并行）:
#
# 配置: 
#   MAX_RESEARCHER_ITERATIONS=1          # 监督者规划1次
#   MAX_REACT_TOOL_CALLS=2               # 每个研究者最多2轮
#   MAX_TOTAL_SEARCHES_PER_RESEARCHER=3  # 每个研究者最多搜索3次
#   MAX_SEARCHES_PER_ITERATION=1         # 每轮搜索1次
#
# 执行流程:
#   监督者第1轮:
#     ├─ 启动研究者A（主题1）
#     │   ├─ 第1轮: 搜索1次 → think
#     │   ├─ 第2轮: 搜索1次 → think → 停止（共2次）
#     │   └─ 返回结果
#     │
#     └─ 启动研究者B（主题2）
#         ├─ 第1轮: 搜索1次 → think
#         ├─ 第2轮: 搜索1次 → think → 停止（共2次）
#         └─ 返回结果
#
#   总搜索次数: 2+2 = 4次 ✅
#
# 如果 MAX_RESEARCHER_ITERATIONS=2，监督者可能再启动1轮研究
#   监督者第2轮:
#     └─ 启动研究者C（补充主题）
#         └─ 搜索1-3次
#
#   总搜索次数: 4 + 1-3 = 5-7次


# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 推荐的配置组合
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

# 【超极简模式】- 每次请求约2-3次搜索（最省钱）
# MAX_RESEARCHER_ITERATIONS=1           # 规划1轮
# MAX_CONCURRENT_RESEARCH_UNITS=1       # 每轮1个研究者
# MAX_REACT_TOOL_CALLS=2                # 研究者2轮
# MAX_TOTAL_SEARCHES_PER_RESEARCHER=2   # 最多搜2次
# MAX_SEARCHES_PER_ITERATION=1          # 每轮1次
# 总研究者: 1×1=1个，总搜索: 约2次

# 【极简模式】- 每次请求约4-6次搜索（推荐）⭐
# MAX_RESEARCHER_ITERATIONS=1           # 规划1轮
# MAX_CONCURRENT_RESEARCH_UNITS=2       # 每轮2个研究者
# MAX_REACT_TOOL_CALLS=2                # 研究者2轮
# MAX_TOTAL_SEARCHES_PER_RESEARCHER=3   # 最多搜3次
# MAX_SEARCHES_PER_ITERATION=1          # 每轮1次
# 总研究者: 1×2=2个，总搜索: 约4-6次

# 【标准模式】- 每次请求约9-15次搜索
# MAX_RESEARCHER_ITERATIONS=2           # 规划2轮
# MAX_CONCURRENT_RESEARCH_UNITS=3       # 每轮3个研究者
# MAX_REACT_TOOL_CALLS=2                # 研究者2轮
# MAX_TOTAL_SEARCHES_PER_RESEARCHER=3   # 最多搜3次
# MAX_SEARCHES_PER_ITERATION=1          # 每轮1次
# 总研究者: 2×3=6个，总搜索: 约12-18次

# 【完整模式】- 每次请求约20-30次搜索（深度研究，您刚才的配置）
# MAX_RESEARCHER_ITERATIONS=2           # 规划2轮
# MAX_CONCURRENT_RESEARCH_UNITS=5       # 每轮5个研究者 ⚠️
# MAX_REACT_TOOL_CALLS=3                # 研究者3轮
# MAX_TOTAL_SEARCHES_PER_RESEARCHER=5   # 最多搜5次
# MAX_SEARCHES_PER_ITERATION=1          # 每轮1次
# 总研究者: 2×5=10个，总搜索: 约20-30次


# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 日志配置
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
LOG_LEVEL=INFO


# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
# 使用说明
# ━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
#
# 1. 复制这个文件: cp config_parameters.env .env
# 2. 填写您的API密钥
# 3. 根据需求选择配置模式（取消对应行的注释）
# 4. 重启服务生效
#
# 观察搜索次数的日志:
#   [RESEARCHER] 📊 第X轮 | 已搜索Y次 | 限制:A轮/B次搜索
#   其中 X ≤ MAX_REACT_TOOL_CALLS
#       Y ≤ MAX_TOTAL_SEARCHES_PER_RESEARCHER

